{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://raw.githubusercontent.com/pgscatalog/pgsc_calc/main/nextflow_schema.json",
  "title": "pgscatalog/pgsc_calc pipeline parameters",
  "description": "Calculate polygenic scores",
  "type": "object",
  "$defs": {
    "input_output_options": {
      "title": "Input/output options",
      "type": "object",
      "fa_icon": "fas fa-terminal",
      "description": "Define where the pipeline should find input data and save output data.",
      "required": ["input", "outdir"],
      "properties": {
        "input": {
          "type": "string",
          "format": "file-path",
          "exists": true,
          "schema": "assets/schema_input.json",
          "pattern": "^\\S+\\.(csv|tsv|json|ya?ml)$",
          "description": "Path to file containing information about the samples in the experiment. Supports CSV, TSV, JSON and YAML.",
          "help_text": "You will need to create a design file with information about the samples in your experiment before running the pipeline. Use this parameter to specify its location. It has to be a comma-separated file with 3 columns, and a header row.",
          "fa_icon": "fas fa-file-csv"
        },
        "outdir": {
          "type": "string",
          "format": "directory-path",
          "description": "The output directory where the results will be saved. You have to use absolute paths to storage on Cloud infrastructure.",
          "fa_icon": "fas fa-folder-open",
          "default": "results/"
        },
        "pgs_id": {
          "type": "string",
          "description": "Select scores that match a PGS Catalog Polygenic Score accession. Select multiple PGS IDs using a comma separated list.",
          "pattern": "^PGS\\d{6}(?:,PGS\\d{6})*$",
          "fa_icon": "fas fa-cloud-download-alt"
        },
        "efo_id": {
          "type": "string",
          "description": "Select scores that match a PGS Catalog Experimental Factor Ontology (EFO) trait. Select multiple traits using a comma separated list.",
          "pattern": "^[A-Z]+_[0-9]+$",
          "fa_icon": "fas fa-cloud-download-alt"
        },
        "pgp_id": {
          "type": "string",
          "description": "Select scores that match a PGS Catalog Publication ID. Select multiple publications using a comma separated list.",
          "pattern": "^PGP\\d{6}(?:,PGS\\d{6})*$",
          "fa_icon": "fas fa-cloud-download-alt"
        },
        "scorefile": {
          "type": "string",
          "description": "Path to a local scoring file.",
          "fa_icon": "fas fa-file-alt"
        },
        "efo_direct": {
          "type": "boolean",
          "fa_icon": "fas fa-cloud",
          "description": "Return only PGS tagged with exact EFO term (e.g. no PGS for child/descendant terms in the ontology)"
        },
        "publish_cache": {
          "type": "boolean",
          "default": true,
          "description": "Publish cached genotypes in a zip file? The zip file can be used in future runs to save time.",
          "fa_icon": "fas fa-file-archive"
        },
        "genotype_cache_zip": {
          "type": "string",
          "pattern": ".*\\.zip$|^.*ZARR_ZIP_NO_FILE$",
          "description": "A zip archive containing cached genotypes, published from a previous run.",
          "format": "file-path",
          "mimetype": "application/zip",
          "fa_icon": "fas fa-file-archive"
        },
        "publish_dir_mode": {
          "type": "string",
          "default": "copy",
          "enum": ["copy", "copyNoFollow", "link", "move", "relink", "symlink"],
          "description": "The file publishing method",
          "fa_icon": "fas fa-upload"
        }
      }
    },
    "compatibility_options": {
      "title": "Compatibility options",
      "type": "object",
      "description": "",
      "default": "",
      "properties": {
        "target_build": {
          "type": "string",
          "description": "Genome build of target genomes.",
          "enum": ["GRCh37", "GRCh38"]
        },
        "chain_files": {
          "type": "string",
          "pattern": "^.*.chain.gz$|CHAIN_NO_FILE",
          "format": "file-path",
          "description": "Path to liftover chain files, see https://hgdownload.cse.ucsc.edu/goldenpath/hg19/liftOver/"
        },
        "variant_batch_size": {
          "type": "integer",
          "default": 5000,
          "description": "How many variants should be stored in each zarr chunk? Larger means more memory usage but potentially faster."
        }
      },
      "fa_icon": "fas fa-dna",
      "required": ["target_build"]
    },
    "matching_options": {
      "title": "Matching options",
      "type": "object",
      "description": "Define how variants are matched across scoring files and target genomes.",
      "default": "",
      "properties": {
        "min_overlap": {
          "type": "number",
          "default": 0.75,
          "minimum": 0,
          "maximum": 1,
          "description": "Minimum proportion of variants present in both the score file and input target genomic data"
        }
      }
    },
    "institutional_config_options": {
      "title": "Institutional config options",
      "type": "object",
      "fa_icon": "fas fa-university",
      "description": "Parameters used to describe centralised config profiles. These should not be edited.",
      "help_text": "The centralised nf-core configuration profiles use a handful of pipeline parameters to describe themselves. This information is then printed to the Nextflow log when you run a pipeline. You should not need to change these values when you run a pipeline.",
      "properties": {
        "custom_config_version": {
          "type": "string",
          "description": "Git commit id for Institutional configs.",
          "default": "master",
          "hidden": true,
          "fa_icon": "fas fa-users-cog"
        },
        "custom_config_base": {
          "type": "string",
          "description": "Base directory for Institutional configs.",
          "default": "https://raw.githubusercontent.com/nf-core/configs/master",
          "hidden": true,
          "help_text": "If you're running offline, Nextflow will not be able to fetch the institutional config files from the internet. If you don't need them, then this is not a problem. If you do need them, you should download the files from the repo and tell Nextflow where to find them with this parameter.",
          "fa_icon": "fas fa-users-cog"
        },
        "config_profile_name": {
          "type": "string",
          "description": "Institutional config name.",
          "hidden": true,
          "fa_icon": "fas fa-users-cog"
        },
        "config_profile_description": {
          "type": "string",
          "description": "Institutional config description.",
          "hidden": true,
          "fa_icon": "fas fa-users-cog"
        },
        "config_profile_contact": {
          "type": "string",
          "description": "Institutional config contact information.",
          "hidden": true,
          "fa_icon": "fas fa-users-cog"
        },
        "config_profile_url": {
          "type": "string",
          "description": "Institutional config URL link.",
          "hidden": true,
          "fa_icon": "fas fa-users-cog"
        }
      }
    },
    "generic_options": {
      "title": "Generic options",
      "type": "object",
      "fa_icon": "fas fa-file-import",
      "description": "Less common options for the pipeline, typically set in a config file.",
      "help_text": "These options are common to all nf-core pipelines and allow you to customise some of the core preferences for how the pipeline runs.\n\nTypically these options would be set in a Nextflow config file loaded for all pipeline runs, such as `~/.nextflow/config`.",
      "properties": {
        "version": {
          "type": "boolean",
          "description": "Display version and exit.",
          "fa_icon": "fas fa-question-circle",
          "hidden": true
        },
        "monochrome_logs": {
          "type": "boolean",
          "description": "Do not use coloured log outputs.",
          "fa_icon": "fas fa-palette",
          "hidden": true
        },
        "validate_params": {
          "type": "boolean",
          "description": "Boolean whether to validate parameters against the schema at runtime",
          "default": true,
          "fa_icon": "fas fa-check-square",
          "hidden": true
        },
        "pipelines_testdata_base_path": {
          "type": "string",
          "fa_icon": "far fa-check-circle",
          "description": "Base URL or local path to location of pipeline test dataset files",
          "default": "https://raw.githubusercontent.com/nf-core/test-datasets/",
          "hidden": true
        },
        "trace_report_suffix": {
          "type": "string",
          "fa_icon": "far calendar",
          "description": "Suffix to add to the trace report filename. Default is the date and time in the format yyyy-MM-dd_HH-mm-ss.",
          "hidden": true
        },
        "help": {
          "type": ["boolean", "string"],
          "description": "Display the help message."
        },
        "help_full": {
          "type": "boolean",
          "description": "Display the full detailed help message."
        },
        "show_hidden": {
          "type": "boolean",
          "description": "Display hidden parameters in the help message (only works when --help or --help_full are provided)."
        }
      }
    }
  },
  "allOf": [
    {
      "$ref": "#/$defs/input_output_options"
    },
    {
      "$ref": "#/$defs/compatibility_options"
    },
    {
      "$ref": "#/$defs/matching_options"
    },
    {
      "$ref": "#/$defs/institutional_config_options"
    },
    {
      "$ref": "#/$defs/generic_options"
    }
  ]
}
